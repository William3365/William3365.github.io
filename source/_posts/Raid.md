---
title: Raid
date: 2023-08-23 09:45:15
tags: Raid
---
# RAID

* 为什么要做raid？
  * 花小钱办大事（降本增效），提供容错机制（数据安全）
  
    

* RAID，独立（廉价）冗余磁盘阵列，简称磁盘阵列，一种多磁盘管理技术

* 用多个独立的磁盘组成在一起形成一个大的磁盘系统，从而实现比单块磁盘更好的存储性能和更高的可靠性。

* 技术架构：数据条带、镜像、数据校验技术
  * stripe条带化阵列，没有冗余，但是可提供最佳性能和附加存储。
  * mirror镜像，阵列中的每个驱动器上镜像相同的数据


  * 根据运用或组合运用这三种技术的策略和架构，可以把 RAID 分为不同的等级，以满足不同数据应用的需求

  * RAID0 - RAID6 七个等级，还有组合raid

    * 标准 RAID 等级各有优势和不足。把多个 RAID 等级组合起来，实现互补，组合等级的实现成本一般都非常昂贵，只是在 少数特定场合应用

  * 在实际应用领域中使用最多的 RAID 等级是 RAID0 、 RAID1 、 RAID3 、 RAID5 、 RAID6 和 RAID10、RAID01。

  * 每一个等级代表一种实现方法和技术，等级之间并无高低之分。在实际应用中，应当根据用户的数据应用特点，综合考虑可用性、性能和成本来选择合适的 RAID 等级，以及具体的实现方式。
* 热备盘

  * 当损坏的盘超出限制，热备盘就会临时顶替掉损坏的磁盘，继续维持原来的数据正常运转，相当于磁盘的最后一层保险

  * 软 RAID，

    ```
    无独立的RAID控制卡，由操作系统和CPU来实现所有的RAID功能。
    
    占用CPU资源，如果操作系统出现故障，则RAID信息会丢失，RAID功能将不可用。
    
    跟硬RAID比性能差，但成本低。
    ```

  * 硬 RAID 

    ```
    拥有独立的RAID控制卡，通过RAID卡实现所有的RAID功能，不占用CPU资源。
    
    性能好，但成本高。
    ```

  * 软硬混合 RAID ，成本、性能居中



## Raid等级

* raid0

  * **最少要用两个磁盘（偶数数量的磁盘）**，一般不单独使用
  * 例：2T + 2T = 4T
  * **不提供数据冗余保护，单个硬盘故障将导致阵列上的所有数据丢失**
  * 视频、音频存储、打印等
* raid1

  * **最少要用两个磁盘（偶数数量的磁盘）**
  * 例：2T + 2T = 2T
  * 数据安全性最高，对硬盘上的数据进行镜像，以在发生硬盘故障时提供容错能力
  * 成本高，磁盘空间利用率为50%，一半的空间用于存储冗余数据
  * 邮件、数据库
* raid5

  * **最少3块**
  * 例：2T + 2T+ 2T = 4T
  * 读取性能相对高，磁盘空间利用率大于RAID 10，**允许1个物理磁盘发生故障，而不丢失数据**（可以理解为 RAID0 和 RAID1 的折中方案，是目前综合性能最佳的数据保护解决方案）
  * 写入性能相对低，重建数据时，性能会受到较大的影响
  * 适用于金融、数据库等
* raid6

  * **最少四块硬盘**
  * 例：2T + 2T + 2T + 2T = 4T
  * 读取性能较高，磁盘空间利用率大于RAID 10，**允许2个物理磁盘发生故障，而不丢失数据**
  * 成本高于RAID 5，写入性能较低（低于RAID 5）
  * 对数据安全要求非常高、成本同样重要的场景，它一般是替代RAID 10经济性选择。如金融、数据库等
* raid10

  * **最少四块硬盘**
  * 例：2T + 2T + 2T + 2T = 4T
  * **RAID 1与RAID 0的结合，先创建RAID 1，再创建RAID 0**
  * 读取性能仅次于RAID 0，磁盘没有全部故障，数据就不会丢失。一半磁盘故障时，仍可正常运转
  * 成本高。磁盘空间利用率50%，一半的空间用于存储冗余数据
  * 于读写性能要求高，数据安全大于磁盘成本的场景。如银行、数据库等。
* raid50

  * **至少需要六个硬盘**
  * 例：2T + 2T + 2T + 2T + 2T + 2T = 8T
  *  RAID 5 + 0
* raid60

  * **最少需要八个硬盘**
  * 例：2T + 2T + 2T + 2T + 2T + 2T + 2T + 2T = 8T
  * 比 RAID 50 阵列更可靠



## Raid状态

若不需配置阵列，则需要将硬盘转换为 non-RAID 直通模式

* 物理磁盘 pd

  * online，可正常使用，处于在线状态

  * ready，该磁盘预备好了，可以被设置为raid但未配置

  * rebuild，重建状态，表示raid组正在进行数据同步

    

* 虚拟磁盘 vd
  * Normal，状态正常，所有成员盘均在线
  * Offline，表示raid组存在超过允许范围的故障或离线硬盘，raid组瘫痪，数据已无法读写
  * Degraded，降级状态，表示raid组中有故障或离线的硬盘，但基于raid组的磁盘仍然可以正常读写
  * Failed，虚拟磁盘故障



## raid选型

* 从I/O性能、成本、容错三个因素来选择

  ```
  如果不考虑容错，选择RAID 0可获得高I/O性能。
  
  如果I/O性能、容错都重要，而成本不是主要因素，可选择RAID 1。
  
  如果I/O性能、成本、容错都重要，则根据磁盘数、可用容量、允许故障硬盘数选择RAID 5、RAID 6、RAID 10、RAID 50或RAID 60
  
  容量>性能，raid50、raid10
  数据保护，raid6、raid60
  
  ```

  

## 注意事项

* 组建RAID时，建议使用硬盘型号、容量完全一样的企业级硬盘。

* 组建RAID会删除硬盘上的所有数据，如有需要请先备份硬盘上的旧数据。

* 已组建RAID的硬盘上存有残留的RAID信息，如需再次组建RAID，需先清除这些信息。

* 先配置raid，再按需分区，最后装系统

* raid和non-raid
  * 不做raid的时候，改成non-raid，这样就可以被系统直接识别
  * non-raid非阵列模式（普通模式），即可独立识别每一块磁盘


## 配置Raid流程
* 1、改sata模式为raid
* 2、做raid
* 3、boot mode模式按需选择

1、检查硬件，可正常工作、安装连接无误

2、根据读盘结果，按需配置raid

3、查看虚拟磁盘配置结果



* mdadm，建设，管理，监控raid
